/*!CK:207381165!*//*1398046832,178134573*/

if (self.CavalryLogger) { CavalryLogger.start_js(["2xhYq"]); }

__d("XAdsPreferencesFeedbackControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f,g){e.exports=g.create("\/ads\/preferences\/feeedback\/",{ad_id:{type:"Int",required:true},favorite:{type:"Enum",required:true}});});
__d("MAdsPrefsFeedback",["cx","CSS","DOM","MRequest","XAdsPreferencesFeedbackControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k){function l(n,o){var p=o?'ad_useful':'ad_neutral',q=new k().setInt('ad_id',n).setEnum('favorite',p).getURI(),r=new j(q);r.send();}var m={toggle:function(n,o,p,q){h.conditionClass(n,"_232h",true);n.addEventListener('webkitAnimationEnd',function(r){h.conditionClass(r.target,"_232h",false);i.replace(r.target,o);},true);l(p,q);}};e.exports=m;});
__d("BehaviorsMixin",["copyProperties"],function(a,b,c,d,e,f,g){function h(l){this._behavior=l;this._enabled=false;}g(h.prototype,{enable:function(){if(!this._enabled){this._enabled=true;this._behavior.enable();}},disable:function(){if(this._enabled){this._enabled=false;this._behavior.disable();}}});var i=1;function j(l){if(!l.__BEHAVIOR_ID)l.__BEHAVIOR_ID=i++;return l.__BEHAVIOR_ID;}var k={enableBehavior:function(l){if(!this._behaviors)this._behaviors={};var m=j(l);if(!this._behaviors[m])this._behaviors[m]=new h(new l(this));this._behaviors[m].enable();return this;},disableBehavior:function(l){if(this._behaviors){var m=j(l);if(this._behaviors[m])this._behaviors[m].disable();}return this;},enableBehaviors:function(l){l.forEach(this.enableBehavior.bind(this));return this;},destroyBehaviors:function(){if(this._behaviors){for(var l in this._behaviors)this._behaviors[l].disable();this._behaviors={};}},hasBehavior:function(l){return this._behaviors&&(j(l) in this._behaviors);}};e.exports=k;});
__d("UnicodeBidiDirection",["keyMirror"],function(a,b,c,d,e,f,g){"use strict";var h=g({NEUTRAL:true,LTR:true,RTL:true});h.isStrong=function(i){return i===h.LTR||i===h.RTL;};e.exports=h;});
__d("Locale",["Style","UnicodeBidiDirection"],function(a,b,c,d,e,f,g,h){var i;function j(){if(i===undefined)i=('rtl'===g.get(document.body,'direction'));return i;}function k(){return j()?h.RTL:h.LTR;}var l={isRTL:j,getDirection:k};e.exports=l;});
__d("MActionBubbleHelper",["CSS","cx"],function(a,b,c,d,e,f,g,h){e.exports.toggleActionBubbleItem=function(i,j){g.conditionClass(i,"_58a0",j);};});
__d("XAdsPreferencesAdInfoControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f,g){e.exports=g.create("\/ads\/preferences\/",{ad_id:{type:"Int"},tracking:{type:"String"},__asyncDialog:{type:"Int"}});});
__d("MHideStoryActions",["$","DOM","DataStore","MActionBubbleHelper","MAdsPrefsFeedback","MParent","MPageController","MRequest","Stratcom","URI","XAdsPreferencesAdInfoControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r='storyFlyout',s='appendPhotosStoryButton',t='hideStoryButton',u='unfollowActorButton',v='blockActorPostsButton',w='markAsSpamStoryButton',x='afroDirectAction',y='removeStoryButton',z='editHistoryButton',aa='editPostButton',ba='publishNowButton',ca='editPrivacyButton',da='turnOffNotifButton',ea='zombieStoryButton',fa='aboutThisAdButton',ga='fitnessEditButton',ha='hideFromTimelineButton',ia='saveButton',ja='unsaveButton',ka='hideStoryOnClick',la='action-title',ma='action-subtitle',na='adsPreferences',oa='adsPreferencesFeedback';function pa(event,za){var ab=za.getCausalElement(),bb=i.get(ab),cb=qa(ab),db=i.get(cb),eb=db.linkdata,fb=null;if(event.getNode(t)){fb=bb.hideURI;}else if(event.getNode(u)||event.getNode(v)){fb=bb.hideAllURI;}else if(event.getNode(w)){fb=bb.markAsSpamURI;}else if(event.getNode(y)){fb=bb.removeURI;}else if(event.getNode(z)){fb=bb.editHistoryURI;}else if(event.getNode(da)){fb=bb.turnOffNotifURI;}else if(event.getNode(x)){var gb=event.getNode(x);fb=i.get(gb).uri;}else if(event.getNode(fa)){fb=bb.aboutThisAdURI;}else if(event.getNode(na)){fb=bb.adsPrefsURI;}else if(event.getNode(ba)){fb=bb.publishNowURI;}else if(event.getNode(ha)){fb=bb.hideFromTimelineURI;}else if(event.getNode(ia)){fb=bb.saveInfo.saveURI;}else if(event.getNode(ja))fb=bb.saveInfo.unsaveURI;var hb=new p(fb);hb.addQueryData('dom_id',cb.id);var ib=bb.hideParams;if(!ib){hb.addQueryData('_ft_',eb);return hb;}var jb=i.get(h.find(cb,'div','scroll-area')),kb=jb.scrollArea,lb=kb.getChildAtPageIndex(kb.getScrollPageIndex()),mb=i.get(h.find(lb,'*','hScrollingItem')),nb=ib[mb.position];hb.addQueryData(nb);var ob=i.get(lb).adId,pb=i.get(lb).linkdata;if(pb)eb=pb;if(ob){i.set(cb,{ai:ob});eb+=':ai.'+ob;}hb.addQueryData('_ft_',eb);return hb;}function qa(za){var ab=l.bySigil(za,'story-popup-metadata');return ab;}function ra(za,ab,bb){var cb=h.find(za,'*',ab);j.toggleActionBubbleItem(cb,bb);}function sa(){var za=i.get(this.getCausalElement()),ab=this.getRoot();ra(ab,y,!!za.removeURI);var bb=h.scry(ab,'*',fa)[0];if(bb)ra(ab,fa,!!za.aboutThisAdURI);var cb=h.scry(ab,'*',t)[0];if(cb)ra(ab,t,!!za.hideURI);var db=h.scry(ab,'*',ha)[0];if(db)ra(ab,ha,!!za.hideFromTimelineURI);var eb=h.scry(ab,'*',s)[0];if(eb){var fb=!!za.appendPhotosURI;if(fb){var gb=i.get(eb);gb.dialogURI=za.appendPhotosURI;}ra(ab,s,fb);}var hb=h.scry(ab,'*',aa)[0];if(hb){var ib=!!za.editPostURI;if(ib){var jb=i.get(hb);jb.dialogURI=za.editPostURI;}ra(ab,aa,ib);}var kb=h.scry(ab,'*',ba)[0];if(kb){var lb=!!za.publishNowURI;ra(ab,ba,lb);if(lb){var mb=i.get(kb);mb.dialogURI=za.publishNowURI;}}var nb=h.scry(ab,'*',z)[0];if(nb){var ob=!!za.editHistoryURI;if(ob){var pb=i.get(nb);pb.dialogURI=za.editHistoryURI;}ra(ab,z,ob);}ra(ab,da,!!za.turnOffNotifURI);var qb=h.scry(ab,'*',ca)[0];if(qb){var rb=!!za.editPrivacyURI;if(rb){var sb=i.get(qb);sb.dialogURI=za.editPrivacyURI;var tb=h.scry(qb,'i')[0];if(tb)h.replace(tb,za.privacyIcon);}ra(ab,ca,rb);}var ub=h.scry(ab,'*',w)[0];if(ub)ra(ab,w,!!za.markAsSpamURI);var vb=h.scry(ab,'*',ga)[0];if(vb){var wb=!!za.fitnessEditURI;if(wb){var xb=i.get(vb);xb.dialogURI=za.fitnessEditURI;}ra(ab,ga,wb);}var yb=h.scry(ab,'*',x);if(yb){var zb=za.afroDirectActions;for(var ac=0;ac<yb.length;ac++){var bc=yb[ac];if(zb&&zb[ac]){var cc=i.get(bc);cc.uri=zb[ac].uri;var dc=h.find(bc,'div',la);dc.textContent=zb[ac].title;var ec=h.find(bc,'div',ma);ec.textContent=zb[ac].subtitle;var fc=h.scry(bc,'i')[0];if(fc)h.replace(fc,zb[ac].icon);j.toggleActionBubbleItem(bc,true);}else j.toggleActionBubbleItem(bc,false);}}var gc=h.scry(ab,'*',ia);if(gc.length===1)if(za.saveInfo&&za.saveInfo.isSaveAction){gc=gc[0];var hc=h.find(gc,'div',la);hc.textContent=za.saveInfo.saveTitle;var ic=h.find(gc,'div',ma);ic.textContent=za.saveInfo.saveSubtitle;ra(ab,ia,true);}else ra(ab,ia,false);var jc=h.scry(ab,'*',ja);if(jc.length===1)if(za.saveInfo&&!za.saveInfo.isSaveAction){jc=jc[0];var kc=h.find(jc,'div',la);kc.textContent=za.saveInfo.unsaveTitle;var lc=h.find(jc,'div',ma);lc.textContent=za.saveInfo.unsaveSubtitle;ra(ab,ja,true);}else ra(ab,ja,false);var mc=h.scry(ab,'*',na);if(mc.length>0)ra(ab,na,!!za.adID);var nc=h.scry(ab,'*',oa);if(nc.length>0){var oc=h.scry(nc[0],'i')[0];if(za.adsPrefsIconActive&&oc){var pc=za.adsPrefsFeedback?za.adsPrefsIconActive:za.adsPrefsIconPassive;h.replace(oc,pc);j.toggleActionBubbleItem(nc[0],true);}else j.toggleActionBubbleItem(nc[0],false);}}function ta(event){var za=i.get(event.getNode(r)),ab=za.layer,bb=ab.getCausalElement(),cb=qa(bb),db=event.getNode(ka);if(event.getNode(ea)){window.open(i.get(bb).zombieStoryURI);ab.hide();return;}if(event.getNode(z)){m.load(i.get(bb).editHistoryURI);ab.hide();return;}if(event.getNode(na)){var eb=new q().setInt('ad_id',i.get(bb).adID).getURI();m.load(eb);ab.hide();return;}var fb=event.getNode(oa);if(fb){var gb=h.scry(fb,'i')[0],hb=i.get(bb).adID,ib=!i.get(bb).adsPrefsFeedback,jb=ib?i.get(bb).adsPrefsIconActive:i.get(bb).adsPrefsIconPassive;k.toggle(gb,jb,hb,ib);i.set(bb,{adsPrefsFeedback:ib});return;}var kb=i.get(bb).saveInfo;if(event.getNode(ia))kb.isSaveAction=false;if(event.getNode(ja))kb.isSaveAction=true;var lb=pa(event,ab),mb=event.getNode(fa);if(mb){window.open(lb.toString());return;}var nb=new n(lb.toString());nb.send();db&&h.hide(cb);ab.hide();}function ua(za,event){var ab=event.getNode('undo-content');if(ab){var bb=i.get(ab).storyDomID,cb=i.get(event.getTarget());if(cb&&cb.href){var db=i.get(g(bb)),eb=db.linkdata;if(db.ai)eb+=':ai.'+db.ai;var fb=(new p(cb.href)).addQueryData('_ft_',eb),gb=new n(fb.toString());gb.send();}if(za)h.show(g(bb));h.hide(ab);}}var va,wa;function xa(){va=null;for(var za=0,ab=wa.length;za<ab;za++)wa[za].remove();wa.length=0;}function ya(za){if(va){va.destroy();xa();}va=za;var ab=va.getRoot();o.addSigil(ab,r);wa=[va.addListener('beforeshow',sa,va),h.listen(ab,'click',null,ta),o.listen('m:page:unload',null,xa),o.listen('click','undo-hide-button',ua.bind(this,true)),o.listen('click','unfab-button',ua.bind(this,false))];}e.exports.init=ya;});
__d("MShareFlyout",["setTimeoutAcrossTransitions","csx","cx","CSSCore","DOM","DataStore","MRequest","Stratcom","MModalDialog","MViewport","Vector","URI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s='share-one-click-button',t="share-with-message-button",u="share-in-a-private-message-button",v='story-div',w='uficontainer',x='m-ufi',y='oneClickShareResult',z=6000,aa='/a/sharer.php',ba='/sharer-dialog.php',ca,da,ea,fa={},ga={},ha=[],ia;function ja(ta,ua){if(ca)return;ia=ua;ca=ta;o.init();na();}function ka(){var ta=new m(aa);ta.setMethod('POST');ta.addData({m:'oneclick',privacyx:ia,sid:da});ta.send();ca.hide();}function la(){o.open(new r(ba).setQueryData({sid:da,_ft_:ea}).toString());ca.hide();}function ma(){o.open(new r(ba).setQueryData({m:'message',sid:da}).toString());ca.hide();}function na(){ha=[ca.addListener('beforeshow',function(){var ta=ca.getCausalElement(),ua=l.get(ta);da=ua&&ua.share_id;var va=new r(ta.href);ea=va.getQueryData()._ft_;if(da)fa[da]=pa(ta);}),n.listen('click',s,ka),n.listen('click',t,la),n.listen('click',u,ma),n.listen('m:page:unload',null,oa)];}function oa(){ca=null;for(var ta in ga)clearTimeout(ga[ta]);ga={};while(ha.length)ha.pop().remove();}function pa(ta){while(ta&&!n.hasSigil(ta,w)&&!n.hasSigil(ta,x)&&!n.hasSigil(ta,v))ta=ta.parentNode;if(j.hasClass(ta,"_56be"))ta=ta.querySelector("._56bf");return ta;}function qa(ta,ua){var va=k.scry(ta,'div',y);va[0]&&k.remove(va[0]);var wa=k.create('div',{className:"_4_m7"},ua);n.addSigil(wa,y);k.appendContent(ta,wa);return wa;}function ra(ta,ua){var va=fa[ua];delete fa[ua];if(!va)return;var wa=qa(va,ta),xa=q.getPos(va),ya=q.getDim(va).y,za=p.getScrollTop(),ab=p.getScrollHeight();if(xa.y<za||xa.y+ya>za+ab)p.scrollTo(xa.x,xa.y-250);ga[ua]=g(function(){delete ga[ua];k.remove(wa);},z);}function sa(ta,ua){var va=fa[ua];delete fa[ua];if(!va)return;if(q.getPos(va).y>=p.getScrollTop()){var wa=qa(va,ta);ga[ua]=g(function(){delete ga[ua];if(q.getPos(va).y>=p.getScrollTop())k.remove(wa);},z);}}f.init=ja;f.onSuccess=sa;f.onFailure=ra;});
__d("MContextualThing",[],function(a,b,c,d,e,f){var g=0,h={register:function(i,j){j.id=j.id||('ctxtlayer_'+g++);i.setAttribute('data-ownerid',j.id);},containsIncludingLayers:function(i,j){while(j){if(i.contains(j))return true;j=h.getContext(j);}return false;},getContext:function(i){var j;while(i){if(i.getAttribute&&(j=i.getAttribute('data-ownerid')))return document.getElementById(j);i=i.parentNode;}return null;}};e.exports=h;});
__d("MLayer",["setTimeoutAcrossTransitions","copyProperties","BehaviorsMixin","CSS","DataStore","DOM","MContextualThing","mixin","mixInEventEmitter","MTouchHelper","Stratcom"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=[],s={},t=n(i);for(var u in t)if(t.hasOwnProperty(u))w[u]=t[u];var v=t===null?null:t.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=t;function w(aa,ba){"use strict";this.$MLayer0=null;this.$MLayer1=false;this.$MLayer2=false;this.$MLayer3=null;this.config=aa||{};if(aa.layerid){if(s[aa.layerid])return;s[aa.layerid]=this;}this.configure(this.config,ba);var ca=this.config.addedBehaviors||[];this.enableBehaviors(this.getDefaultBehaviors().concat(ca));}w.prototype.configure=function(aa,ba){"use strict";this.$MLayer0=this.buildWrapper(aa,ba);q.addSigil(this.$MLayer0,'m-layer-root');if(aa.attributes)aa.attributes.forEach(function(ca){this.$MLayer0.setAttribute(this.root,ca);},this);if(aa.classNames)aa.classNames.forEach(function(ca){j.conditionClass(this.$MLayer0,ca,true);},this);if(aa.causalElement)this.$MLayer3=aa.causalElement;k.set(this.$MLayer0,{layer:this});};w.prototype.getDefaultBehaviors=function(){"use strict";return [];};w.prototype.getCausalElement=function(){"use strict";return this.$MLayer3;};w.prototype.setCausalElement=function(aa){"use strict";this.$MLayer3=aa;return this;};w.prototype.getInsertParent=function(){"use strict";return this.insertParent||document.body;};w.prototype.getRoot=function(){"use strict";return this.$MLayer0;};w.prototype.getContentRoot=function(){"use strict";return this.$MLayer0;};w.prototype.buildWrapper=function(aa,ba){"use strict";return ba;};w.prototype.setInsertParent=function(aa){"use strict";if(aa){if(this.$MLayer1&&aa!==this.getInsertParent()){l.appendContent(aa,this.getRoot());this.updatePosition();}this.insertParent=aa;}return this;};w.prototype.show=function(){"use strict";if(this.$MLayer1)return this;var aa=this.getRoot();this.emit('beforeshow');aa.style.visibility='hidden';aa.style.overflow='hidden';l.show(aa);l.appendContent(this.getInsertParent(),aa);if(this.updatePosition()!==false){this.$MLayer1=true;this.emit('show');q.invoke('Layer:show',null,this);g(function(){if(this.$MLayer1)r.push(this);}.bind(this));}else l.hide(aa);aa.style.visibility='';aa.style.overflow='';this.emit('aftershow');return this;};w.prototype.hide=function(){"use strict";if(this.$MLayer2||!this.$MLayer1||this.emit('beforehide')===false)return this;this.$MLayer2=true;if(this.emit('starthide')!==false)this.finishHide();return this;};w.prototype.conditionShow=function(aa){"use strict";return aa?this.show():this.hide();};w.prototype.finishHide=function(){"use strict";if(this.$MLayer1){r.splice(r.indexOf(this),1);this.$MLayer2=false;this.$MLayer1=false;l.hide(this.getRoot());this.emit('hide');q.invoke('m:layer:hide',null,this);}return this;};w.prototype.isShown=function(){"use strict";return this.$MLayer1;};w.prototype.updatePosition=function(){"use strict";return true;};w.prototype.updateIfShown=function(){"use strict";this.isShown()&&this.updatePosition();};w.prototype.destroy=function(){"use strict";this.finishHide();var aa=this.getRoot();l.remove(aa);this.destroyBehaviors();this.emit('destroy');q.invoke('Layer:destroy',null,this);delete k.get(aa).layer;this.$MLayer0=this.$MLayer3=null;if(this.config.layerid)delete s[this.config.layerid];this.config=null;};o(w,{destroy:true,blur:true,beforeshow:true,show:true,aftershow:true,beforehide:true,starthide:true,hide:true});h(w,{show:function(aa){aa.show();}});var x;function y(event){x=p.getTouchClientCoord(event);}function z(event){var aa=r.length;if(!aa)return;var ba=event.getTarget(),ca=event.getType();if(ca==='touchend'&&x){var da=p.getTouchClientCoord(event),ea=Math.sqrt(Math.pow(x.x-da.x,2)+Math.pow(x.y-da.y,2));x=null;if(ea>5)return;}if(!document.documentElement.contains(ba))return;while(aa--){var fa=r[aa];if(!fa.isShown())continue;var ga=fa.getContentRoot();if(m.containsIncludingLayers(ga,ba))return;var ha=fa.getCausalElement();if(ca==="touchend"&&(ha.contains(ba)||ha===ba))continue;if(fa.emit('blur')===false||fa.isShown())return;}}q.listen('touchstart',null,y);q.listen('click',null,z);q.listen('touchend',null,z);e.exports=w;});
__d("MLayerDestroyOnTransition",["Stratcom"],function(a,b,c,d,e,f,g){function h(i){"use strict";this.$MLayerDestroyOnTransition0=null;this.$MLayerDestroyOnTransition1=i;}h.prototype.enable=function(){"use strict";this.$MLayerDestroyOnTransition0=g.listen('m:page:unload',null,this.$MLayerDestroyOnTransition1.destroy.bind(this.$MLayerDestroyOnTransition1));};h.prototype.disable=function(){"use strict";this.$MLayerDestroyOnTransition0.remove();this.$MLayerDestroyOnTransition0=null;};e.exports=h;});
__d("MLayerHideOnBlur",[],function(a,b,c,d,e,f){function g(h){"use strict";this.$MLayerHideOnBlur0=null;this.$MLayerHideOnBlur1=null;this.$MLayerHideOnBlur2=h;}g.prototype.enable=function(){"use strict";this.$MLayerHideOnBlur0=[this.$MLayerHideOnBlur2.addListener('show',this.$MLayerHideOnBlur3.bind(this)),this.$MLayerHideOnBlur2.addListener('hide',this.$MLayerHideOnBlur4.bind(this))];if(this.$MLayerHideOnBlur2.isShown())this.$MLayerHideOnBlur3();};g.prototype.disable=function(){"use strict";this.$MLayerHideOnBlur4();while(this.$MLayerHideOnBlur0.length)this.$MLayerHideOnBlur0.pop().remove();this.$MLayerHideOnBlur0=null;};g.prototype.$MLayerHideOnBlur4=function(){"use strict";this.$MLayerHideOnBlur1&&this.$MLayerHideOnBlur1.remove();this.$MLayerHideOnBlur1=null;};g.prototype.$MLayerHideOnBlur3=function(){"use strict";this.$MLayerHideOnBlur1=this.$MLayerHideOnBlur2.addListener('blur',function(){this.$MLayerHideOnBlur2.hide();return false;}.bind(this));};e.exports=g;});
__d("MInputFocus",["setTimeoutAcrossTransitions","DOM","MJSEnvironment","MViewport"],function(a,b,c,d,e,f,g,h,i,j){var k={scrollTo:function(l,m){if(i.IS_APPLE_WEBKIT_IOS&&parseInt(i.OS_VERSION,10)>=6){h.hide(l);j.scrollTo(0,m);g(function(){h.show(l);l.setSelectionRange(l.selectionEnd,l.selectionEnd);},0);}else j.scrollTo(0,m);}};e.exports=k;});
__d("MCommentActionsFlyout",["DOM","DataStore","MParent","MRequest","Stratcom","URI","MActionBubbleHelper","MPageController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o='editCommentSigil',p='replyCommentSigil',q='deleteCommentSigil',r='commentFlyoutSigil';function s(ca,da,ea){var fa=g.find(ca,'*',da);m.toggleActionBubbleItem(fa,ea);}function t(ca){var da=i.bySigil(ca,'comment-metadata');return da;}function u(ca,da){var ea=h.get(da);ca.addQueryData('_ft_',ea.linkdata);}function v(ca,da){u(da,ca);var ea=new j(da);ea.send();}function w(ca,da){u(da,ca);n.load(da.toString());}function x(){var ca=t(this.getCausalElement()),da=this.getRoot(),ea=h.get(ca);s(da,o,!!(ea.editCommentURI));s(da,p,!!(ea.replyCommentURI));s(da,q,!!(ea.deleteCommentURI));}function y(ca){var da=h.get(ca.getNode(r)),ea=t(da.layer.getCausalElement()),fa=h.get(ea);if(ca.getNode(o)){v(ea,new l(fa.editCommentURI));}else if(ca.getNode(p)){w(ea,new l(fa.replyCommentURI));}else if(ca.getNode(q))v(ea,new l(fa.deleteCommentURI));da.layer.hide();ca.kill();}var z,aa,ba=function(ca){if(z)return;z=ca;var da=ca.getRoot();k.addSigil(da,r);aa=[k.listen('m:page:unload',null,function(){while(aa.length>0)aa.pop().remove();z=null;}),ca.addListener('beforeshow',x,ca),g.listen(da,'click',null,y)];};e.exports={registerFlyout:ba};});
__d("MFlyout",["CSS","DataStore","DOM","Locale","MContextualThing","MLayer","MParent","Stratcom","Vector","MJSEnvironment","copyProperties","cx","emptyFunction","mixInEventEmitter"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=52,v=26,w=10,x=22,y=3,z=400,aa=320,ba=['resize','m:viewport:orientation-change','m:orientation-resize:complete','m:hideout:reflow','m:landscape-cover-crop:complete'],ca='flyout-causal';function da(ma,na,oa){return Math.min(oa,Math.max(na,ma));}function ea(){return document.body;}var fa=[];for(var ga in l)if(l.hasOwnProperty(ga))ia[ga]=l[ga];var ha=l===null?null:l.prototype;ia.prototype=Object.create(ha);ia.prototype.constructor=ia;ia.__superConstructor__=l;function ia(ma,na){"use strict";this._contentRoot=null;this._contentWrapper=null;this._nubNode=null;this._nubAlignment=null;this._content=null;this._contextNode=null;this._parentLayer=null;this._parentSubscription=null;this._orientation=null;this._orientationClass=null;this._width=null;l.call(this,ma,na);}ia.prototype.configure=function(ma,na){"use strict";ha.configure.call(this,ma,na);if(ma.context){this.setContext(ma.context);this.setParentSubscription();n.addSigil(this.getCausalElement(),ca);var oa=h.get(this.getCausalElement());oa.flyout=this;}this.setMargin(ma.margin);this.setPosition(ma.position);this.setNubAlign(ma.nubalign);this.setOffsetY(ma.offsetY);this._content=na;this.setWidth(ma.width);};ia.prototype.setWidth=function(ma){"use strict";this._width=ma;};ia.prototype._getLayerParentWidth=function(){"use strict";return o.getDim(this.getRoot().offsetParent).x;};ia.prototype.getMaxWidth=function(){"use strict";return Math.min(this._getLayerParentWidth(),p.IS_TABLET?aa:z);};ia.prototype._maxWidthIsApplicable=function(){"use strict";return this.getMaxWidth()!==this._getLayerParentWidth();};ia.prototype._isCustomWidth=function(){"use strict";return this._width==='auto'||this._maxWidthIsApplicable();};ia.prototype.applyWidth=function(){"use strict";var ma=this._contentRoot.style;ma.width='';ma.maxWidth='';if(this._maxWidthIsApplicable()){var na=this.getMaxWidth()+'px';if(this._width==='auto'){ma.maxWidth=na;}else ma.width=na;}g.conditionClass(this._contentRoot,"_556f",this._isCustomWidth());};ia.prototype.buildWrapper=function(ma,na){"use strict";this._nubNode=i.create('div',{className:"_5bn_"});this._backgroundNode=i.create('div',{className:"_5c0e"},this._nubNode);var oa=i.create('div',{className:"_5c0f"},na);this._contentRoot=i.create('div',{className:"_5bo0"},[this._backgroundNode,oa]);if(j.isRTL())this._contentRoot.style.direction='rtl';this._contentWrapper=i.create('div',{className:"_544k"},this._contentRoot);return i.create('div',{className:"_544l"},this._contentWrapper);};ia.prototype.setMargin=function(ma){"use strict";g.conditionClass(this._contentRoot,"_54wl",ma==='large');g.conditionClass(this._contentRoot,"_55kj",ma==='medium');};ia.prototype.getInsertParent=function(){"use strict";var ma=this.insertParent;if(!ma){var na=this.getContext();if(na)ma=m.bySigil(na,'context-layer-root')||ea();}return ma||ha.getInsertParent.call(this);};ia.prototype.setContent=function(ma){"use strict";this._content=ma;i.setContent(this._contentRoot,this._content);this.updateIfShown();return this;};ia.prototype.setContext=function(ma){"use strict";this._contextNode=ma;};ia.prototype.getCausalElement=function(){"use strict";return ha.getCausalElement.call(this)||this.getContext();};ia.prototype.setParentSubscription=function(){"use strict";var ma=this.getContext(),na=null,oa=ea().parentNode;while(ma!==oa){na=h.get(ma).layer;if(na)break;ma=ma.parentNode;}if(na===this._parentLayer)return;if(this._parentLayer&&this._parentSubscription){this._parentSubscription.remove();this._parentSubscription=null;}if(na)this._parentSubscription=na.subscribe('hide',this.hide.bind(this));this._parentLayer=na;};ia.prototype.setPosition=function(ma){"use strict";if(this.getOrientation().setDefaultPosition(ma)){this.getOrientation().setPosition(ma);this.updateIfShown();}return this;};ia.prototype.setNubAlign=function(ma){"use strict";ka(ma);this._nubAlignment=ma||'center';};ia.prototype.setOffsetY=function(ma){"use strict";ma=parseInt(ma,10);if(this.getOrientation().setDefaultOffsetY(ma))this.updateIfShown();return this;};ia.prototype.getOrientation=function(){"use strict";if(!this._orientation)this._orientation=new la();return this._orientation;};ia.prototype.getContentRoot=function(){"use strict";return this._contentRoot;};ia.prototype.getContent=function(){"use strict";return this._content;};ia.prototype.getContext=function(){"use strict";return this._contextNode;};ia.prototype.getContextBounds=function(){"use strict";return this.getContext().getBoundingClientRect();};ia.prototype.causalClickShow=function(){"use strict";this.getContent()&&this.show();};ia.prototype.show=function(){"use strict";if(this.isShown())return this;ha.show.call(this);if(this.isShown()){k.register(this.getRoot(),this.getContext());fa.push(this);if(!this.resizeListeners){var ma=this.updatePosition.bind(this);this.resizeListeners=ba.map(function(na){return n.listen(na,null,ma);});}}return this;};ia.prototype.finishHide=function(){"use strict";fa.splice(fa.indexOf(this),1);while(this.resizeListeners&&this.resizeListeners.length)this.resizeListeners.pop().remove();this.resizeListeners=null;n.invoke('m:flyout:close',null,{flyout:this});return ha.finishHide.call(this);};ia.prototype.updatePosition=function(){"use strict";var ma=this.getContext();if(!ma)return false;if(!ma.offsetParent)return false;this.applyWidth();this.emit('adjustDimensions');var na=this.getRoot(),oa=this.getOrientation();this.emit('adjust',oa.reset());this.updateWrapperClass(oa);var pa=na.offsetParent,qa=pa.getBoundingClientRect(),ra=this.getContextBounds(),sa=ra.left-qa.left,ta=ra.top-qa.top+pa.scrollTop;if(oa.getPosition()==='below')ta+=ra.height;var ua=this.getContentRoot(),va=0;if(this._isCustomWidth()){var wa=ua.clientWidth,xa=sa+Math.round(ra.width/2);va=da(Math.round(xa-wa/2),0,this._getLayerParentWidth()-wa);ua.style.left=va+'px';}else ua.style.left='';na.style.top=(ta+oa.getOffsetY())+'px';var ya=this._nubAlignment,za=sa;if(ra<v)ya='center';if(ya==='center'){za+=Math.round(ra.width/2);}else if(this._nubAlignment==='left'){za+=v/2;}else za+=ra.width-v/2;var ab=q({},ua.getBoundingClientRect());ab.left-=qa.left;var bb=y+v/2;za=da(za,ab.left+bb,ab.left+ab.width-bb);var cb=za-u/2-ab.left;this._nubNode.style.left=cb+'px';this.emit('reposition',oa);return true;};ia.prototype._toggleOrientationClass=function(ma,na){"use strict";g.conditionClass(this._contentWrapper,na||this._orientationClass,ma);};ia.prototype.updateWrapperClass=function(ma){"use strict";var na=ma.getClassName();if(na===this._orientationClass)return;if(this._orientationClass)this._toggleOrientationClass(false);this._orientationClass=na;this._toggleOrientationClass(true);};ia.prototype.simulateOrientation=function(ma,na){"use strict";var oa=ma.getClassName();if(oa===this._orientationClass){return na();}else{if(this._orientationClass)this._toggleOrientationClass(false);this._toggleOrientationClass(true,oa);var pa=na();this._toggleOrientationClass(false,oa);if(this._orientationClass)this._toggleOrientationClass(true);return pa;}};ia.prototype.destroy=function(){"use strict";ha.destroy.call(this);this._contextNode=null;this._contextSigil=null;this._contentRoot=null;this._contentWrapper=null;this._content=null;this._nubNode=null;this._width=null;return this;};t(ia,{adjustDimensions:true,adjust:true,reposition:true});var ja=s.thatReturnsArgument,ka=s.thatReturnsArgument;function la(){"use strict";this._default={_position:'above',_offsetY:0};this.reset();}la.prototype.setPosition=function(ma){"use strict";this._position=ja(ma);return this;};la.prototype.getOppositePosition=function(){"use strict";return la.OPPOSITE[this.getPosition()];};la.prototype.getPosition=function(){"use strict";return this._position||'above';};la.prototype.getOffsetY=function(){"use strict";var ma=this._offsetY||0;if(this._position==='above'){ma-=x;ma*=-1;}else if(this._position==='below')ma-=w;return ma;};la.prototype.getClassName=function(){"use strict";var ma=this.getPosition();if(ma==='below'){return "_5bo1";}else if(ma==='above')return "_5bo2";};la.prototype.reset=function(){"use strict";q(this,this._default);return this;};la.prototype.setDefaultPosition=function(ma){"use strict";var na=this._default._position;this._default._position=ja(ma);return na!==ma;};la.prototype.setDefaultOffsetY=function(ma){"use strict";var na=this._default._offsetY;this._default._offsetY=ma;return na!==ma;};la.OPPOSITE={above:'below',below:'above'};n.listen('click',ca,function(ma){h.get(ma.getNode(ca)).flyout.causalClickShow();});n.listen('click',['m-layer-root','mflyout-remove-on-click'],function(ma){var na=ma.getNode('m-layer-root');h.get(na).layer.hide();});e.exports=ia;});
__d("MActionBubbleLayout",["CSS","cx"],function(a,b,c,d,e,f,g,h){function i(j){"use strict";this.$MActionBubbleLayout0=null;this.$MActionBubbleLayout1=j;}i.prototype.enable=function(){"use strict";this.$MActionBubbleLayout0=this.$MActionBubbleLayout1.addListener('adjustDimensions',this.$MActionBubbleLayout2.bind(this));if(this.$MActionBubbleLayout1.isShown())this.$MActionBubbleLayout1.updatePosition();};i.prototype.disable=function(){"use strict";this.$MActionBubbleLayout0.remove();this.$MActionBubbleLayout0=null;if(this.$MActionBubbleLayout1.isShown())this.$MActionBubbleLayout1.updatePosition();};i.prototype.$MActionBubbleLayout2=function(){"use strict";var j=this.$MActionBubbleLayout1;this.$MActionBubbleLayout3(true);var k=this.$MActionBubbleLayout1.getContentRoot();if(k.clientWidth>=j.getMaxWidth())this.$MActionBubbleLayout3(false);};i.prototype.$MActionBubbleLayout3=function(j){"use strict";var k=this.$MActionBubbleLayout1;k.setWidth(j?'auto':'wide');k.applyWidth();g.conditionClass(k.getRoot(),"_55i0",j);};e.exports=i;});
__d("MFlyoutAutoFlip",["MViewport","MParent"],function(a,b,c,d,e,f,g,h){function i(j){"use strict";this.$MFlyoutAutoFlip0=null;this.$MFlyoutAutoFlip1=j;}i.prototype.enable=function(){"use strict";this.$MFlyoutAutoFlip0=this.$MFlyoutAutoFlip1.addListener('adjust',this.$MFlyoutAutoFlip2.bind(this));if(this.$MFlyoutAutoFlip1.isShown())this.$MFlyoutAutoFlip1.updatePosition();};i.prototype.disable=function(){"use strict";this.$MFlyoutAutoFlip0.remove();this.$MFlyoutAutoFlip0=null;if(this.$MFlyoutAutoFlip1.isShown())this.$MFlyoutAutoFlip1.updatePosition();};i.prototype.$MFlyoutAutoFlip2=function(j){"use strict";var k=this.$MFlyoutAutoFlip3(j),l={top:0,bottom:g.getUseableHeight()},m=h.bySigil(this.$MFlyoutAutoFlip1.getRoot(),'scroll-area');if(m){var n=m.getBoundingClientRect();l={top:Math.max(n.top,l.top),bottom:Math.min(n.bottom,l.bottom)};}var o,p,q=this.$MFlyoutAutoFlip1,r=q.getContext(),s=r.getBoundingClientRect();for(o=0;o<k.length;o++){j.setPosition(k[o]);p=q.simulateOrientation(j,function(){return q.getRoot().firstChild.getBoundingClientRect();});var t=s.top+j.getOffsetY();if(j.getPosition()==='above'){t-=p.height;}else if(j.getPosition()==='below')t+=s.height;var u={top:t,bottom:t+p.height};if(u.top>=l.top&&u.bottom<=l.bottom)return;}j.setPosition(k.indexOf('below')>-1?'below':k[0]);};i.prototype.$MFlyoutAutoFlip3=function(j){"use strict";return [j.getPosition(),j.getOppositePosition()];};e.exports=i;});
__d("MFlyoutContextSigil",["Stratcom","DataStore","DOM","ex"],function(a,b,c,d,e,f,g,h,i,j){var k={};function l(m){"use strict";this.$MFlyoutContextSigil0=null;this.$MFlyoutContextSigil1=m;}l.prototype.enable=function(){"use strict";var m=this.$MFlyoutContextSigil2();k[m];k[m]=this.$MFlyoutContextSigil1;this.$MFlyoutContextSigil0=g.listen('click',this.$MFlyoutContextSigil2(),this.$MFlyoutContextSigil3.bind(this));};l.prototype.disable=function(){"use strict";delete k[this.$MFlyoutContextSigil2()];this.$MFlyoutContextSigil0.remove();this.$MFlyoutContextSigil0=null;this.$MFlyoutContextSigil1=null;};l.prototype.$MFlyoutContextSigil2=function(){"use strict";var m=this.$MFlyoutContextSigil1.config;return m.causalSigil||m.contextSigil;};l.prototype.$MFlyoutContextSigil3=function(m){"use strict";var n=m.getNode(this.$MFlyoutContextSigil2()),o,p=this.$MFlyoutContextSigil1.config.contextSigil,q=this.$MFlyoutContextSigil1.config.causalSigil;if(q&&q!==p){var r=n;while(r&&r!==document.body&&!o)if(g.hasSigil(r,p)){o=r;}else{var s=i.scry(r,'*',p);o=s[0];r=r.parentNode;}}else o=n;if(this.$MFlyoutContextSigil1.getContext()!==o&&this.$MFlyoutContextSigil1.isShown())this.$MFlyoutContextSigil1.hide();this.$MFlyoutContextSigil1.setCausalElement(n);this.$MFlyoutContextSigil1.setContext(o);h.get(n).flyout=this.$MFlyoutContextSigil1;if(!this.$MFlyoutContextSigil1.isShown())this.$MFlyoutContextSigil1.show();m.prevent();};e.exports=l;});