(function(){if(!Array.prototype.indexOf)Array.prototype.indexOf=function(obj,fromIndex){if(fromIndex==null)fromIndex=0;else if(fromIndex<0)fromIndex=Math.max(0,this.length+fromIndex);for(var i=fromIndex,j=this.length;i<j;i++)if(this[i]===obj)return i;return-1};var ttDiv=document.createElement("div");ttDiv["id"]="totaltagdiv";var tt_scripts=document.getElementsByTagName("script");var tt_index=tt_scripts.length-1;var tt_myScript=tt_scripts[tt_index];if(tt_myScript!=null)tt_myScript.parentNode.insertBefore(ttDiv,
tt_myScript);var referrerToAssetUrl={"http://discover.economist.com/index.html":{"html":2229277},"http://economist.com/":{"html":2229278},"http://discover.economist.com/":{"html":2229275}};var wildcardToAssetUrl={"^http://discover\\.economist\\.com/\\#.*$":{"html":2229276},"^http://.*subscriptions.*$":{"html":2229273},"^http://.*school.*$":{"html":2229272},"^http://.*technology.*$":{"html":2229274},"^http://.*finance.*$":{"html":2229269},"^http://.*education.*$":{"html":2229268},"^http://.*register.*$":{"html":2229271},
"^http://.*politics.*$":{"html":2229270},"^http://.*economics.*$":{"html":2229267},"^http://.*business.*$":{"html":2229266}};var allowedParams=[];var expectedDomains=["discover.economist.com","economist.com","stage.economist.com","subscriptions.economist.com"];function totaltag(url){var totalTagDiv=document.getElementById("totaltagdiv");totalTagDiv.innerHTML="";var tempUrl=url.replace(/ /,"").replace(/\|/,"%7C");tempUrl=tempUrl.replace(/^(https?):\/\/(www\.)?/i,"$1://").replace(/;jsessionid=[^;?]*/,
"");var urlparts=tempUrl.split("?");if(urlparts.length>=2&&allowedParams.length!=0){var parameterArray=[];for(var param in allowedParams){var urlParameter=encodeURIComponent(allowedParams[param])+"\x3d";var pars=urlparts[1].split(/[&;]/g);for(var i=pars.length;i-- >0;)if(pars[i].indexOf(urlParameter,0)==0){parameterArray.push(pars[i]);break}if(parameterArray.length>0)tempUrl=urlparts[0]+"?"+parameterArray.sort().join("\x26");else tempUrl=urlparts[0]}}else tempUrl=urlparts[0];var urlDomain,assetUrl,
isInvalidUrl=false,domainValid=true;try{urlDomain=urlparts[0].match(/:\/\/(.[^\/]+)/)[1]}catch(err){urlDomain=tempUrl;isInvalidUrl=true}if(expectedDomains.length!=0&&expectedDomains.indexOf(urlDomain)==-1)domainValid=false;if(domainValid){if(!isInvalidUrl){var tempA=document.createElement("a");tempA.href=tempUrl;tempUrl=tempA.href}assetUrl=referrerToAssetUrl[tempUrl];var tt_regex=/([^\?]*)(\?.*)/;var match=tt_regex.exec(tt_myScript.src);var tt_queryParams=match!=null?match[2]:"";var extraParams=[];
if(document.referrer!="")extraParams.push("httpReferrer\x3d"+encodeURIComponent(document.referrer));extraParams.push("httpLocation\x3d"+encodeURIComponent(url));if(typeof prop11!=="undefined")extraParams.push("prop11\x3d"+prop11);if(extraParams.length>0)if(tt_queryParams==="")tt_queryParams="?"+extraParams.join("\x26");else tt_queryParams=tt_queryParams+"\x26"+extraParams.join("\x26");var source;if(assetUrl!=null){var htmlAsset=assetUrl["html"];if(htmlAsset!=null){source="//d21j20wsoewvjq.cloudfront.net/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/14485/"+
htmlAsset+".html"+tt_queryParams;populateDynamiciFrame(source,totalTagDiv)}var jsAsset=assetUrl["js"];if(jsAsset!=null){source="//d21j20wsoewvjq.cloudfront.net/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/14485/"+jsAsset+".js"+tt_queryParams;loadEmbeddedScript(source,totalTagDiv)}}for(var w in wildcardToAssetUrl){var asset=wildcardToAssetUrl[w];re=new RegExp(w,"i");if(tempUrl.match(re)){assetUrl=asset;var htmlWAsset=assetUrl["html"];if(htmlWAsset!=null){source="//d21j20wsoewvjq.cloudfront.net/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/14485/"+
htmlWAsset+".html"+tt_queryParams;populateDynamiciFrame(source,totalTagDiv)}var jsWAsset=assetUrl["js"];if(jsWAsset!=null){source="//d21j20wsoewvjq.cloudfront.net/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/14485/"+jsWAsset+".js"+tt_queryParams;loadEmbeddedScript(source,totalTagDiv)}}}source="//d21j20wsoewvjq.cloudfront.net/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/14485/global.html"+tt_queryParams;populateDynamiciFrame(source,totalTagDiv)}}function loadEmbeddedScript(source,
totalTagDiv){var s=document.createElement("script"),e=document.getElementsByTagName("script")[0];s.type="text/javascript";s.async=true;s.src=source;e.parentNode.insertBefore(s,e)}function populateDynamiciFrame(sourceUrl,tdiv){var iFrame=document.createElement("iframe");tdiv.appendChild(iFrame);iFrame["src"]=sourceUrl;iFrame.style.display="none";return true}totaltag(document.location.href);window["totaltag"]=totaltag})();
