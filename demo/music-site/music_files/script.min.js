function Sound(){this.play=function(){this.src.play();var a=this;if(this.fade)var b=setInterval(function(){a.src.volume<.9?a.src.volume+=.1:clearInterval(b)},100)},this.pause=function(){var a=this;if(this.fade)var b=setInterval(function(){a.src.volume>.1?a.src.volume-=.1:(clearInterval(b),a.src.pause())},40);else this.src.pause()},this.vol=function(a){this.src.volume=a}}function Scratch(){}function preload(){var a=0,b=sound.length+2*scratch.length;for(i=0;i<sound.length;i++){var c=new Sound,d=new Audio;d.src=sound[i].src,c.src=d,sound[i].fade?(c.fade=!0,c.src.volume=0):(c.fade=!1,c.src.volume=1),c.src.addEventListener("canplay",function(){a++}),sound[i].loop&&c.src.addEventListener("ended",function(){this.currentTime=0,this.play()}),sound[i]=c}for(i=0;i<scratch.length;i++){var c=new Scratch,e=new Audio;e.src=scratch[i].quick,c.quick=e;var f=new Audio;f.src=scratch[i].slow,c.slow=f,scratch[i]=c,c.quick.addEventListener("canplay",function(){a++}),c.slow.addEventListener("canplay",function(){a++})}var g=setInterval(function(){a==b&&($("#turntable").show(),$("#loading").hide(),initDOM(),clearInterval(g))},10)}function play(){spinInterval=setInterval(function(){if(0!=lastMouseY&&clicked){var a=lastMouseY-mouseY;0==vinylSide?rotatet+=a:1==vinylSide&&(rotatet-=a)}else rotatet+=step;$("#vinyl > .bottom").css("transform","rotate("+rotatet+"deg)"),$("#vinyl > .bottom").css("-ms-transform","rotate("+rotatet+"deg)"),$("#vinyl > .bottom").css("-webkit-transform","rotate("+rotatet+"deg)"),speed=20*(a/16),lastMouseY=mouseY,rotatet>360&&720>rotatet?rotatet-=360:rotatet>720&&(rotatet=(rotatet-(360*Math.floor(rotatet/360)-360))%360)},16),scratchInterval=setInterval(function(){speed>20&&scratch[ranNum(0,3)].quick.play(),speed>10&&20>=speed&&scratch[ranNum(0,3)].slow.play(),-20>speed&&scratch[ranNum(0,3)].quick.play(),-10>speed&&speed>=-20&&scratch[ranNum(0,3)].slow.play(),$("#log").html(vinylSide)},10),sound[1].play(),sound[0].play(),$("#turntable > .on").show()}function pause(){clearInterval(spinInterval),clearInterval(scratchInterval),sound[1].play(),sound[0].pause(),$("#turntable > .on").hide()}function initDOM(){$("#vinyl-cover").bind("mousedown",function(a){a.preventDefault(),clicked=!0}),$("#vinyl-cover").bind("mousemove",function(a){var b=a.pageX-$(this).offset().left,c=a.pageY-$(this).offset().top;clicked&&(mouseY=c),116>=b&&(vinylSide=0),b>116&&(vinylSide=1)}),$("#vinyl-cover").bind("mouseover",function(){$("#hand").show()}),$("#vinyl-cover").bind("mouseout",function(){$("#hand").hide(),clicked=!1}),$("#vinyl-cover").bind("mouseup",function(a){a.preventDefault(),clicked=!1}),$("#turntable").bind("mousemove",function(a){var b=a.pageX-$("#turntable").offset().left,c=a.pageY-$("#turntable").offset().top;$("#hand").css("top",c).css("left",b)}),$("#turntable").bind("mouseover",function(){initialized||(play(),on=!0,initialized=!0)}),$("#turntable").bind("mouseout",function(){clicked=!1}),$("#button").bind("click",function(){on?on&&(pause(),on=!1):(play(),on=!0)}),$("#turntable > #tma").hover(function(){$("#tma-image").show()},function(){$("#tma-image").hide()}),$("#tma").bind("click",function(){window.open($(this).attr("data-link"),"_parent")})}function ranNum(a,b){return Math.floor(Math.random()*(b-a)+a)}var ext,isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,isFirefox="undefined"!=typeof InstallTrigger,isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,isChrome=!!window.chrome&&!isOpera,isIE=!1||!!document.documentMode;ext=isFirefox||isOpera?"ogg":"mp3";var initialized=!1,spinInterval,scratchInterval,rotatet=0,step=2,clickY=0,clicked=!1,mouseY=0,lastMouseY=0,speed=0,on=!1,vinylSide,sound=[{id:0,src:"sounds/loop."+ext,loop:!0,fade:!0},{id:1,src:"sounds/click."+ext,loop:!1,fade:!1}],scratch=[{id:0,quick:"sounds/scratch1."+ext,slow:"sounds/scratch1_2."+ext},{id:1,quick:"sounds/scratch2."+ext,slow:"sounds/scratch2_2."+ext},{id:2,quick:"sounds/scratch3."+ext,slow:"sounds/scratch3_2."+ext},{id:3,quick:"sounds/scratch4."+ext,slow:"sounds/scratch4_2."+ext}];$(document).ready(function(){var b=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;b&&window.location.assign("index_touch.html"),preload()});